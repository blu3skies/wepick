language: ruby
rvm:
- 2.6.5
env:
  global:
  - RAILS_ENV=test
  - CC_TEST_REPORTER_ID=6ff37add0aecefe2ddea29e8ebbb74798071c5c2fcf9cf90e27bdb89196896bb
  - secure: noOR/WySD4obxjmFfYqD2N8DBmafwDzXUrJbHgfq4EQQPGKBvBoHdRuV0KA9K74xvm7VgdoDhhXIqpbcQF1PjU+b4enVnyE5xyB8LQoQb2eC/2cuakl9Q0wrqTpjfYvTIW240QApllFfYxpeQhb+R5/FGIXwcslADOxLRq745gvadaCND1vtx+oogH9b4arMzqsAaj0K6ZInyPUMBk2ms29tfpsoOJQbxjVF3fYFK57HUd0RshAOEpyoztOlw4k+Eju4uwsG9/9ClGOgpvVkDu/1+cAqsgPoVz3cumShA1Pks+bEDZ+JQvWNItVmfi6DdewlQhNbZjEjGfbasCOuVFB2EmN3zMCkJPwCZNgxy2PydiC3Nx2U6eTMOym0VP1ksG4990d8nHjVDaOfwUwUI830Krf0iYxq4p2F0RN7fYCLz3T9mBFYXDh8PVDQf31L0WrbPxHw/mEUBBClsqBXZSMIaZqNEE8NNtUTuQjIlkQiV3rlhvZ7/cSFOlLs/v2mpJFZ/cAM3/udUNWKhwPbDx+MTgRFZTyoLLCv7D0jpUEuuVgnLjxBDYO90m1maqeVdhXFmltuIHfOMPFjM4Vfc+D03axAtzHL1gIgI/UsSVJg/SU/8mrCo1MDQxxLTJBWFeAZ5tikZJ3n62BGBgbsUJgQwJ538bwKvh9IL9IRUUM=
services:
- postgresql
before_script:
- bundle exec rails db:create
- bundle exec rails db:migrate
- curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64
  > ./cc-test-reporter
- chmod +x ./cc-test-reporter
- "./cc-test-reporter before-build"
cache:
  bundler: true
  directories:
  - node_modules
  yarn: true
install:
- bundle install
- nvm install node
- node -v
- npm i -g yarn
- yarn
script:
- bundle exec rails webpacker:compile
- bundle exec rspec
- bundle exec rubocop
branches:
  only:
  - master
after_script:
- "./cc-test-reporter after-build -t simplecov --exit-code $TRAVIS_TEST_RESULT"
deploy:
  provider: heroku
  skip_cleanup: true
  app: wepick
  on:
    repo: jasylwong/wepick
  run:
  - bundle exec rails db:migrate
  - bundle exec rails db:seed
  api_key:
    secure: oQ4ktnfHwxYhX8dWGC7/rhL45z8WQuqzwUArqxDHZCkBqoeNEfl3ZcZgTXlMcLnSERCady2SGM3vyCdxnNGj80LfbX7EeJPn6ppt4blRvoMBb+CLn6DqpROybps1mNWiw/WUu5mFFmO4WeBKBtgXU48X/CEFluhquFs2LaIu00LBac8jpOjuPWmWLJsoDG19zBVcFdT5aj2KX4MDMzR3YMAwfhnvIU0y1BJ1hm6JbXwUx9+CQZ5EzzUpKh7NsUMvsYGAEA5crOjUdnCFFqwVG/UNZi1oeEMl99wSfrZka401kC+kB5h9W+xdB18P0td2GWaWB9Zqt9WQmEJLNglmk4PjOI1kbesdvE51QPKws5CfTKYy758FcWcUcf8Rb2uQNrltIZqZQFHyjIKNe3eN8t7AVt5KAdiCIfUFV2eX+zKbjn+18aVBH7pj1KcCjzdMOdxu1mi+qZ8R0fDUDCoRTauneJ0dov5Yndc5gQY+oJbUAjvNfKtfEQbydsP1SbQqPuohJU4nr9dKmVnJNnx3vmNG+WwuBtQbhMYcb26+HCr3GlThj6MHcG9jmQ/DKXmqUA2uzjAhbTitqCNui8iEiBzEnpBdubh0vM96Em5MRnDkTCdB7mOohR31HHMCWEdfsZzvFLdOZjyGT7TRuaXDIhBt7cTlAchtY2C2nntuYGc=
